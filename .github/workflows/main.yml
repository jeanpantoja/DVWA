name: CI
on:
 push:
   branches: [ master ]
 pull_request:
   branches: [ master ]

jobs:
 conviso:
   runs-on: ubuntu-latest
   container:
     image: convisoappsec/flowcli
     env:
       FLOW_API_KEY:  ${{secrets.FLOW_API_KEY}}
       FLOW_PROJECT_CODE: "LMNT2Mt0ka3YmZWM"
   steps:
   - uses: actions/checkout@v2

   - name: Run SAST
     run: flow sast run
   
   - name: Security Gate Validation
     run: flow vulnerability assert-security-rules --rules-file rules.yml
